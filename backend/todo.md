1. refactor repository use entity directly
2. transaction